<!DOCTYPE html><html><head><meta charset=utf-8><title>qbittorrent-breach</title></head><body><h1>qbittorrent-breach</h1><blockquote><p>qBittorrent security reports</p></blockquote><p><a href=http://opengg.github.io/qBittorrent-breach/ >http version</a></p><p><a href=https://opengg.github.io/qBittorrent-breach/ >https version</a></p><h2>CSRF-related</h2><h3>The WebUI implementation flaws</h3><p>The implementation of <a href=https://github.com/qbittorrent/qBittorrent/wiki/WebUI-API-Documentation#get-alternative-speed-limits-state>qBittorrent WebUI</a> request handler does'nt do well against <a href=https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet>CSRF attacks</a>.</p><p>This project demonstrates how attackers can control users' qBittorrent processes, manipulating victims' categories, tasks and settings, without being notice.</p><h3>APIs affected</h3><p>Nearly all WebUI apis are CSRF-flawed, affecting qBittorrent &lt;= v3.3.12.</p><table><thead><tr><th>api</th><th>note</th></tr></thead><tbody><tr><td>/logout</td><td>A remote attacker can logout users' current qBittorrent WebUI session.</td></tr><tr><td>/command/shutdown</td><td>A remote attacker can make qBittorrent processes exit.</td></tr><tr><td>/command/download</td><td>A remote attacker can add download tasks to qBittorrent.</td></tr><tr><td>/command/upload</td><td>A remote attacker can add download tasks to qBittorrent.</td></tr><tr><td>/command/addTrackers</td><td>A remote attacker can add a trackers to a torrent task. (Need torrent hash)</td></tr><tr><td>/command/pause</td><td>A remote attacker can pause a torrent task. (Need torrent hash)</td></tr><tr><td>/command/pauseAll</td><td>A remote attacker can pause all torrent tasks.</td></tr><tr><td>/command/resume</td><td>A remote attacker can resume a torrent task. (Need torrent hash)</td></tr><tr><td>/command/resumeAll</td><td>A remote attacker can resume all torrent tasks.</td></tr><tr><td>/command/delete</td><td>A remote attacker can delete a torrent task. (Need torrent hash)</td></tr><tr><td>/command/deletePerm</td><td>A remote attacker can delete a torrent task with downloaded data. (Need torrent hash)</td></tr><tr><td>/command/recheck</td><td>A remote attacker can make qBittorrent recheck a torrent task. (Need torrent hash)</td></tr><tr><td>/command/increasePrio</td><td>A remote attacker can increase torrent priority. (Need torrent hash)</td></tr><tr><td>/command/decreasePrio</td><td>A remote attacker can decrease torrent priority. (Need torrent hash)</td></tr><tr><td>/command/topPrio</td><td>A remote attacker can maximal torrent priority. (Need torrent hash)</td></tr><tr><td>/command/bottomPrio</td><td>A remote attacker can minimal torrent priority. (Need torrent hash)</td></tr><tr><td>/command/setFilePrio</td><td>A remote attacker can set torrent priority. (Need torrent hash)</td></tr><tr><td>/command/setGlobalDlLimit</td><td>A remote attacker can set global download limit.</td></tr><tr><td>/command/setGlobalUpLimit</td><td>A remote attacker can set global upload limit.</td></tr><tr><td>/command/setTorrentsDlLimit</td><td>A remote attacker can set torrent download limit. (Need torrent hash)</td></tr><tr><td>/command/setTorrentsUpLimit</td><td>A remote attacker can set torrent upload limit. (Need torrent hash)</td></tr><tr><td>/command/setCategory</td><td>A remote attacker can set torrent category. (Need torrent hash)</td></tr><tr><td>/command/addCategory</td><td>A remote attacker can add new category.</td></tr><tr><td>/command/removeCategories</td><td>A remote attacker can remove categories.</td></tr><tr><td>/command/setPreferences</td><td>A remote attacker can set qBittorrent preferences.</td></tr><tr><td>/command/toggleAlternativeSpeedLimits</td><td>A remote attacker can toggle alternative speed limits.</td></tr><tr><td>/command/toggleSequentialDownload</td><td>A remote attacker can toggle sequential download. (Need torrent hash)</td></tr><tr><td>/command/toggleFirstLastPiecePrio</td><td>A remote attacker can set first/last piece priority. (Need torrent hash)</td></tr><tr><td>/command/setForceStart</td><td>A remote attacker can set force start. (Need torrent hash)</td></tr></tbody></table><h3>Security tips for users</h3><p>If you are using qBittorrent v3.3.12 or below, I strongly suggest you to upgrade to <a href=https://github.com/qbittorrent/qBittorrent/releases>qBittorrent v3.3.13 or above</a> immediately.</p><p>If you do need a legacy version of qBittorrent and can not upgrade, I suggest you to turn off WebUI and use native UI instead.</p><div id=app></div><script>(function(a){for(var i=0;i<a.length;++i){b=document.createElement('link');b.rel='stylesheet';b.href=a[i];document.body.appendChild(b)}})(["static/css/app.86b1e40f0f700327109315951ffc3e67.css"])</script><script src=static/js/manifest.08423cb48b840e3dcc01.js></script><script src=static/js/vendor.81020db1a96b7bf716ab.js></script><script src=static/js/app.b4fb75449ee5e003d8ef.js></script></body></html>